pipeline{

  agent any

  tools {
    jdk 'JDK17-2'
    maven 'Maven3'
  }
  stages {
    stage ('Cleanup Workspace'){
      steps{
        cleanWs()
      } 
    }
    stage('Checkout from SCM'){
      steps{
         git branch: 'main', changelog: false, credentialsId: 'Jenkins_agents', poll: false, url: 'https://github.com/DevOp-Edureka/sample-maven-project-2.git'
      }
    }
    stage('Build Application'){
      steps{
        sh 'mvn clean package'
      }
    }
    stage('Test Aplication') {
      steps{
        sh 'mvn test'
    }
  }
  stage('Sonarqube Analysis'){
    steps{
      withSonarQubeEnv(credentialsId:'jenkins-sonar-token-key'){
        sh 'mvn sonar:sonar'

      }
    }
  }
}

}
